<!DOCTYPE html>
<html lang="ko"
	  xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout/default">

<!-- 사용자 CSS 추가 -->
<th:block layout:fragment="css">
</th:block>

<!-- 사용자 스크립트 추가 -->
<th:block layout:fragment="script">
	<script src="/assets/js/bxslider/jquery.bxslider.min.js"></script>

	<script>
		$(document).ready(function() {

			if (navigator.userAgent.match(/iPad/) == null && navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/) != null) {
				console.log("mobile")
			}else{
				console.log("pc")
				noticePopUp();
			}

			$("#popWin").on('click',function(){
				popWin(1044,580,'yes');
			});

			var slider = $('.banner__slide').bxSlider({
							controls: false,
							pagerCustom: '.banner__slide-pager'
						});
			
			$(window).load(function() {
				var width_size = window.outerWidth;
				var height_size = window.outerHeight;
				
				if(width_size >768 && height_size <= 990) {
					slider.reloadSlider();
				} else if(width_size > 768 && height_size > 990) {
					slider.destroySlider();
				}
			});

			
			$(window).resize(function () {
				var width_size = window.outerWidth;
				var height_size = window.outerHeight;
				
				if(width_size >768 && height_size <= 990) {
					slider.reloadSlider();
				} else if(width_size > 768 && height_size > 990) {
					slider.destroySlider();
				}
			});

		})
		var setting;

		// 공지사항 팝업
		function noticePopUp() {

			var token = $("meta[name='_csrf']").attr("content");
			var header = $("meta[name='_csrf_header']").attr("content");
			$(document).ajaxSend(function(e, xhr) { xhr.setRequestHeader(header, token); });

			$.ajax({
				url:'/api/notice/Popup',
				type : 'post',
				cache:false,
				error:function(request){
					ajaxErrorMsg(request);
				},
				success: function(res) {
					for(var i=0; i<res.data.noticeId.length; i++) {
						winPop(res.data.noticeId[i]);
					}
				}
			});
		}

		function winPop(id) {
			var noticePop
			var href = "/notice/noticeviewPopup/"+id;
			setting = "width=" + 1044 + ", height=" + 580 + ", top=5, left=20, scrollbar=yes"
			noticePop = window.open(href,"",setting);
			noticePop.focus();
		}

		function sweetalertclick() {
			alertCaution('권한이 필요합니다.<br> 로그인해주시길 바랍니다');
		}

		function popWin(width, height, scroll) {
			var newWindow;
			setting = "width=" + width + ", height=" + height + ", top=5, left=20, scrollbars=" + scroll
			newWindow = window.open ("/statistics/statisticsview" , "통계 상세보기", setting);
			newWindow.focus();
		}

	</script>
	
</th:block>



<div layout:fragment="content" class="content">
	
	<div class="main">
		<div class="main__text">
			<p>KICT 건설119</p>
			<p>"국민과 인프라의 안전 확보를 위하여 전문가로서 최선을 다하겠습니다."</p>
			<div class="main__img"></div>
		</div>
		<div class="banner">
			<ul class="banner__list">

				<li class="banner__item banner__item--write" sec:authorize="isAuthenticated()"><a href="javascript:void(0);" onclick="mobileCheckIndex();" class="banner__link">출동일지작성</a></li>
				<li class="banner__item banner__item--write-list" sec:authorize="isAuthenticated()"><a href="/record/list" class="banner__link">출동일지조회</a></li>
				<li class="banner__item banner__item--line" sec:authorize="isAuthenticated()"><a href="about/lineup" class="banner__link">건설 119 출동대원 라인업</a></li>
				<li class="banner__item banner__item--guide" sec:authorize="isAuthenticated()"><a href="/record/GuideLine" target="_blank" class="banner__link">건설 119 주요 활동 가이드라인</a></li>
				<li class="banner__item banner__item--notice" sec:authorize="isAuthenticated()"><a href="/notice/noticelist" class="banner__link">공지사항</a></li>

				<li class="banner__item banner__item--write" sec:authorize="!isAuthenticated()"><a style="cursor:pointer" onclick="sweetalertclick()" class="banner__link">출동일지작성</a></li>
				<li class="banner__item banner__item--write-list" sec:authorize="!isAuthenticated()"><a href="/record/list" class="banner__link">출동일지조회</a></li>
				<li class="banner__item banner__item--line" sec:authorize="!isAuthenticated()"><a href="about/lineup" class="banner__link">건설 119 출동대원 라인업</a></li>
				<li class="banner__item banner__item--guide" sec:authorize="!isAuthenticated()"><a style="cursor:pointer" onclick="sweetalertclick()" class="banner__link">건설 119 주요 활동 가이드라인</a></li>
				<li class="banner__item banner__item--notice" sec:authorize="!isAuthenticated()" ><a href="/notice/noticelist" class="banner__link">공지사항</a></li>

				<li class="banner__item banner__item--table">
					<div class="banner__stat">
						<h3 class="banner__title">KICT 건설119 활동 통계</h3>
						<span class="main-table__unit">단위: 건</span>
						<div class="banner__slide">
							<div class="banner__slide-item">
								<table class="main-table">
									<colgroup>
										<col />
										<col />
										<col />
										<col />
									</colgroup>
									<tbody>
										<tr>
											<th>붕괴</th>
											<th>화재 &frasl; 폭발</th>
											<th>지진</th>
											<th>싱크홀</th>
										</tr>
										<tr>
											<td  th:text="${arDisasters[0]}"></td>
											<td  th:text="${arDisasters[1]}"></td>
											<td  th:text="${arDisasters[2]}"></td>
											<td  th:text="${arDisasters[3]}"></td>
										</tr>
										<tr>
											<th>교통사고</th>
											<th>홍수 &frasl; 가뭄</th>
											<th>환경오염</th>
											<th class="sum">합계</th>
										</tr>
										<tr>
											<td  th:text="${arDisasters[4]}"></td>
											<td  th:text="${arDisasters[5]}"></td>
											<td  th:text="${arDisasters[6]}"></td>
											<td  th:text="${arDisasters[7]}"></td>
										</tr>
									</tbody>
								</table>
							</div>
							<div class="banner__slide-item">
								<table class="main-table">
									<colgroup>
										<col />
										<col />
										<col />
										<col />
									</colgroup>
									<tbody>
										<tr>
											<th>교량</th>
											<th>옹벽 &frasl; 비탈면</th>
											<th>터널</th>
											<th>건축물</th>
										</tr>
										<tr>
											<td th:text="${arFacs[0]}"></td>
											<td th:text="${arFacs[1]}"></td>
											<td th:text="${arFacs[2]}"></td>
											<td th:text="${arFacs[3]}"></td>
										</tr>
										<tr>
											<th>도로 &frasl; 시설물</th>
											<th>지반 &frasl; 지하</th>
											<th>기타</th>
											<th>합계</th>
										</tr>
										<tr>
											<td th:text="${arFacs[4]}"></td>
											<td th:text="${arFacs[5]}"></td>
											<td th:text="${arFacs[6]}"></td>
											<td th:text="${arFacs[7]}"></td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
						<div class="banner__slide-pager">
							<ul>
								<li><a href="#" data-slide-index="0">1</a></li>
								<li><a href="#" data-slide-index="1">2</a></li>
							</ul>
						</div>
						<a id="popWin" class="banner__stat-link">상세보기&gt;&gt;</a>
					</div>
				</li>
			</ul>
		</div>
	</div>
</div>
</html>
